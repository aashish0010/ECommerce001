import './polyfills.server.mjs';
import{a as k,b as w,c as _,d as b,e as A,f as I,g as L}from"./chunk-5MQJU5P3.mjs";import{h as S}from"./chunk-SQVLAE5Q.mjs";import{i as y}from"./chunk-ZSAWBTYV.mjs";import{a as l}from"./chunk-5NRLYQRM.mjs";import{F as v}from"./chunk-2RBLLN6M.mjs";import{m as c,n as g,o as u}from"./chunk-KL6F6H7P.mjs";import{X as d,ca as p,ha as i,i as a}from"./chunk-KHPBT355.mjs";import{a as m,b as f}from"./chunk-S6KH3LOX.mjs";var x=(()=>{class s{constructor(){this.http=i(v),this.skeletonLoader=!1}getOrders(e){return this.http.get(`${l.baseURL}order`)}viewOrder(e){return this.http.get(`${l.baseURL}order/${e}`)}orderTracking(e){return this.http.get(`${l.URL}/trackOrder`,{params:e})}placeOrder(e){return this.http.post(`${l.baseURL}order`,e)}static{this.\u0275fac=function(t){return new(t||s)}}static{this.\u0275prov=p({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();var n=class h{constructor(){this.notificationService=i(y),this.router=i(S),this.orderService=i(x)}static order(r){return r.order}static selectedOrder(r){return r.selectedOrder}static checkout(r){return r.checkout}getOrders(r,e){return this.orderService.getOrders(e?.payload).pipe(d({next:t=>{let o=Array.isArray(t)?t:t?.data??[];r.patchState({order:{data:o,total:o.length}})},error:t=>{throw new Error(t?.error?.message)}}))}viewOrder(r,{id:e}){this.orderService.skeletonLoader=!0;let t=r.getState().order.data;if(t?.length){let o=t.find(O=>O.order_number==e);r.patchState({selectedOrder:o??null}),this.orderService.skeletonLoader=!1;return}return this.orderService.getOrders().pipe(d({next:o=>{let j=(Array.isArray(o)?o:o?.data??[]).find(R=>R.order_number==e);r.patchState({selectedOrder:j??null})},error:o=>{throw new Error(o?.error?.message)},complete:()=>{this.orderService.skeletonLoader=!1}}))}checkout(r,e){let t=r.getState(),o={total:{convert_point_amount:65.66,convert_wallet_balance:8.47,coupon_total_discount:10,points:1970,points_amount:65.66,shipping_total:0,sub_total:39.81,tax_total:1.99,total:41.8,wallet_balance:8.47}};r.patchState(f(m({},t),{checkout:o}))}placeOrder(r,e){return this.orderService.placeOrder(e.payload).pipe(d({next:t=>{this.notificationService.showSuccess(`Order placed successfully! Order #${t.order_number}`),this.router.navigate(["/"])},error:t=>{this.notificationService.showError(t?.error?.message||"Failed to place order. Please try again.")}}))}rePayment(r,e){}orderTracking(r,e){return this.orderService.orderTracking(e.payload).pipe(d({next:t=>{let o=r.getState();r.patchState(f(m({},o),{selectedOrder:t}))},error:t=>{throw new Error(t?.error?.message)}}))}downloadInvoice(r,e){}static{this.\u0275fac=function(e){return new(e||h)}}static{this.\u0275prov=p({token:h,factory:h.\u0275fac})}};a([c(k)],n.prototype,"getOrders",null);a([c(w)],n.prototype,"viewOrder",null);a([c(_)],n.prototype,"checkout",null);a([c(b)],n.prototype,"placeOrder",null);a([c(A)],n.prototype,"rePayment",null);a([c(I)],n.prototype,"orderTracking",null);a([c(L)],n.prototype,"downloadInvoice",null);a([u()],n,"order",null);a([u()],n,"selectedOrder",null);a([u()],n,"checkout",null);n=a([g({name:"order",defaults:{order:{data:[],total:0},selectedOrder:null,checkout:null}})],n);export{n as a};
