import{i as U}from"./chunk-X54HSUE6.js";import{a as d}from"./chunk-XBPV4G5P.js";import{m as c,n as w,o as l}from"./chunk-HS6BDBTJ.js";import{A as S}from"./chunk-QOHFTPSE.js";import{X as n,ca as u,ha as p,i as o}from"./chunk-63KUFEGV.js";import{a as m,b as A}from"./chunk-4CLCTAJ7.js";var g=(()=>{class r{static{this.type="[Account] User Get"}constructor(){}}return r})(),v=(()=>{class r{static{this.type="[Account] User Update"}constructor(e){this.payload=e}}return r})(),N=(()=>{class r{static{this.type="[Account] User Update Password"}constructor(e){this.payload=e}}return r})(),P=(()=>{class r{static{this.type="[Account] Addresses Get"}constructor(){}}return r})(),y=(()=>{class r{static{this.type="[Account] Address Create"}constructor(e){this.payload=e}}return r})(),b=(()=>{class r{static{this.type="[Account] Address Edit"}constructor(e,s){this.payload=e,this.id=s}}return r})(),x=(()=>{class r{static{this.type="[Account] Address Delete"}constructor(e){this.id=e}}return r})(),D=(()=>{class r{static{this.type="[Account] Clear"}constructor(){}}return r})();var C=(()=>{class r{constructor(){this.http=p(S),this.isOpenMenu=!1}getUserDetails(){return this.http.get(`${d.baseURL}user/me`)}updateProfile(e){return this.http.put(`${d.baseURL}user/profile`,e)}updatePassword(e){return this.http.put(`${d.baseURL}user/password`,{currentPassword:e.current_password,newPassword:e.new_password,confirmPassword:e.confirm_password})}getAddresses(){return this.http.get(`${d.baseURL}address`)}createAddress(e){return this.http.post(`${d.baseURL}address`,e)}updateAddress(e,s){return this.http.put(`${d.baseURL}address/${e}`,s)}deleteAddress(e){return this.http.delete(`${d.baseURL}address/${e}`)}static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275prov=u({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var i=class h{constructor(){this.accountService=p(C),this.notificationService=p(U)}static user(t){return t.user}static permissions(t){return t.permissions}static addresses(t){return t.addresses}getUserDetails(t){return this.accountService.getUserDetails().pipe(n({next:e=>{let s=A(m({},e),{name:[e.firstName,e.middleName,e.lastName].filter(Boolean).join(" ")||e.name,phone:e.phoneNumber||e.phone});t.patchState({user:s,permissions:e.permission||[]})},error:e=>{throw new Error(e?.error?.message)}}))}updateProfile(t,{payload:e}){if(e instanceof FormData){this.notificationService.showError("Profile image upload is not yet supported");return}return this.accountService.updateProfile(e).pipe(n({next:()=>{this.notificationService.showSuccess("Profile updated successfully");let s=t.getState().user;if(s){let a=[e.firstName,e.middleName,e.lastName].filter(Boolean).join(" ");t.patchState({user:A(m({},s),{firstName:e.firstName??s.firstName,middleName:e.middleName??s.middleName,lastName:e.lastName??s.lastName,phoneNumber:e.phoneNumber??s.phoneNumber,phone:e.phoneNumber??s.phone,name:a||s.name})})}},error:s=>{this.notificationService.showError(s?.error?.message||"Failed to update profile")}}))}updatePassword(t,{payload:e}){return this.accountService.updatePassword(e).pipe(n({next:()=>{this.notificationService.showSuccess("Password changed successfully")},error:s=>{this.notificationService.showError(s?.error?.message||"Failed to change password")}}))}getAddresses(t){return this.accountService.getAddresses().pipe(n({next:e=>{t.patchState({addresses:e})},error:e=>{throw new Error(e?.error?.message)}}))}createAddress(t,{payload:e}){return this.accountService.createAddress(e).pipe(n({next:s=>{let a=t.getState();t.patchState({addresses:[...a.addresses,s]})},error:s=>{throw new Error(s?.error?.message)}}))}updateAddress(t,{id:e,payload:s}){return this.accountService.updateAddress(e,s).pipe(n({next:a=>{let E=t.getState();t.patchState({addresses:E.addresses.map(f=>f.id===e?a:f)}),this.notificationService.showSuccess("Address updated successfully")},error:a=>{this.notificationService.showError(a?.error?.message||"Failed to update address")}}))}deleteAddress(t,{id:e}){return this.accountService.deleteAddress(e).pipe(n({next:()=>{let s=t.getState();t.patchState({addresses:s.addresses.filter(a=>a.id!==e)}),this.notificationService.showSuccess("Address deleted successfully")},error:s=>{this.notificationService.showError(s?.error?.message||"Failed to delete address")}}))}accountClear(t){t.patchState({user:null,permissions:[],addresses:[]})}static{this.\u0275fac=function(e){return new(e||h)}}static{this.\u0275prov=u({token:h,factory:h.\u0275fac})}};o([c(g)],i.prototype,"getUserDetails",null);o([c(v)],i.prototype,"updateProfile",null);o([c(N)],i.prototype,"updatePassword",null);o([c(P)],i.prototype,"getAddresses",null);o([c(y)],i.prototype,"createAddress",null);o([c(b)],i.prototype,"updateAddress",null);o([c(x)],i.prototype,"deleteAddress",null);o([c(D)],i.prototype,"accountClear",null);o([l()],i,"user",null);o([l()],i,"permissions",null);o([l()],i,"addresses",null);i=o([w({name:"account",defaults:{user:null,permissions:[],addresses:[]}})],i);export{g as a,v as b,P as c,y as d,b as e,x as f,D as g,C as h,i};
