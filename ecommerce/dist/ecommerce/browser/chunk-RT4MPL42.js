import{a as B,b as E,c as I,d as A,e as $,f as j,g as k}from"./chunk-VBJNOOMQ.js";import{A as b,E as u}from"./chunk-KTUN43P2.js";import{$ as h,C as w,O as v,U as n,ea as d,g as r,j as S,n as C,qd as s,rd as G,sd as i}from"./chunk-XZ37OMXB.js";import{a as f,b as m}from"./chunk-4CLCTAJ7.js";var x=(()=>{class y{constructor(){this.http=d(b),this.searchSkeleton=!1,this._cache$=null}getCategories(a){return this._cache$?this._cache$:(this._cache$=this.http.get(`${u.baseURL}product/categories`,{params:{companyInfoId:u.companyInfoId,status:1}}).pipe(C(t=>{let g=t.data||t.categories||[];return{data:[...g],total:g.length}}),v(1),w(t=>(this._cache$=null,S(()=>t)))),this._cache$)}getCategoryBySlug(a){return this.getCategories().pipe(C(t=>{let g=t.data||[];for(let c of g){if(c.slug===a)return c;if(c.subcategories?.length){let l=c.subcategories.find(F=>F.slug===a);if(l)return l}}return g[0]}))}static{this.\u0275fac=function(t){return new(t||y)}}static{this.\u0275prov=h({token:y,factory:y.\u0275fac,providedIn:"root"})}}return y})();var o=class p{constructor(){this.categoryService=d(x)}static category(e){return e.category}static categories(e){return e.categories}static footerCategory(e){return e.footerCategory}static headerCategory(e){return e.headerCategory}static productCategory(e){return e.productCategory}static subCategory(e){return e.category}static searchByCategory(e){return e.searchByCategory}static selectedCategory(e){return e.selectedCategory}getCategories(e,a){if(!(e.getState().categories.data.length>0))return this.categoryService.getCategories(a.payload).pipe(n({next:t=>{t&&t.data&&e.patchState({categories:{data:t.data,total:t?.total?t?.total:t.data.length}})},error:t=>{throw new Error(t?.error?.message)}}))}getCategory(e,a){if(!(e.getState().category.data.length>0))return this.categoryService.getCategories(a.payload).pipe(n({next:t=>{t&&t.data&&e.patchState({category:{data:t.data,total:t?.total?t?.total:t.data.length}})},error:t=>{throw new Error(t?.error?.message)}}))}GetFooterCategories(e,a){if(!(e.getState().footerCategory.data.length>0))return this.categoryService.getCategories(a.payload).pipe(n({next:t=>{t&&t.data&&e.patchState({footerCategory:{data:t.data,total:t?.total?t?.total:t.data.length}})},error:t=>{throw new Error(t?.error?.message)}}))}GetHeaderCategories(e,a){if(!(e.getState().headerCategory.data.length>0))return this.categoryService.getCategories(a.payload).pipe(n({next:t=>{t&&t.data&&e.patchState({headerCategory:{data:t.data,total:t?.total?t?.total:t.data.length}})},error:t=>{throw new Error(t?.error?.message)}}))}GetProductCategory(e,a){return this.categoryService.getCategories(a.payload).pipe(n({next:t=>{e.patchState({productCategory:{data:t.data,total:t?.total?t?.total:t.data.length}})},error:t=>{throw new Error(t?.error?.message)}}))}getSearchByCategory(e,a){return this.categoryService.searchSkeleton=!0,this.categoryService.getCategories(a.payload).pipe(n({next:t=>{let g;a?.payload?.search?g=t.data.filter(c=>c.name.toLowerCase().includes(a?.payload?.search.toLowerCase())):g=t.data,e.patchState({searchByCategory:g?g.slice(0,4):[]})},error:t=>{throw new Error(t?.error?.message)},complete:()=>{this.categoryService.searchSkeleton=!1}}))}getCategoryBySlug(e,a){return this.categoryService.getCategories().pipe(n({next:t=>{if(t&&t.data){let g=t.data.find(l=>l.slug==a.slug),c=e.getState();e.patchState(m(f({},c),{selectedCategory:g}))}},error:t=>{throw new Error(t?.error?.message)}}))}getSubCategory(e,a){if(a?.includes(e.id)&&e)return e;e.subcategories?.length&&e.subcategories.map(t=>{this.getSubCategory(t,a)})}static{this.\u0275fac=function(a){return new(a||p)}}static{this.\u0275prov=h({token:p,factory:p.\u0275fac})}};r([s(B)],o.prototype,"getCategories",null);r([s(E)],o.prototype,"getCategory",null);r([s(I)],o.prototype,"GetFooterCategories",null);r([s(A)],o.prototype,"GetHeaderCategories",null);r([s($)],o.prototype,"GetProductCategory",null);r([s(j)],o.prototype,"getSearchByCategory",null);r([s(k)],o.prototype,"getCategoryBySlug",null);r([i()],o,"category",null);r([i()],o,"categories",null);r([i()],o,"footerCategory",null);r([i()],o,"headerCategory",null);r([i()],o,"productCategory",null);r([i()],o,"subCategory",null);r([i()],o,"searchByCategory",null);r([i()],o,"selectedCategory",null);o=r([G({name:"category",defaults:{category:{data:[],total:0},categories:{data:[],total:0},footerCategory:{data:[],total:0},headerCategory:{data:[],total:0},productCategory:{data:[],total:0},searchByCategory:[],selectedCategory:null}})],o);export{x as a,o as b};
