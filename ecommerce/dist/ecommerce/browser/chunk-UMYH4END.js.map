{
  "version": 3,
  "sources": ["src/app/shared/store/action/compare.action.ts", "src/app/shared/services/compare.service.ts", "src/app/shared/store/state/compare.state.ts"],
  "sourcesContent": ["import { Params } from '../../interface/core.interface';\n\nexport class GetCompareAction {\n  static readonly type = '[Compare] Get';\n}\n\nexport class AddToCompareAction {\n  static readonly type = '[Compare] post';\n  constructor(public payload: Params) {}\n}\n\nexport class DeleteCompareAction {\n  static readonly type = '[Compare] delete';\n  constructor(public id: number) {}\n}\n", "import { HttpClient } from '@angular/common/http';\nimport { Injectable, inject } from '@angular/core';\n\nimport { Observable } from 'rxjs';\n\nimport { environment } from '../../../environments/environment';\nimport { ICompareModel } from '../interface/compare.interface';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CompareService {\n  private http = inject(HttpClient);\n\n  public skeletonLoader: boolean = false;\n\n  getComparItems(): Observable<ICompareModel> {\n    return this.http.get<ICompareModel>(`${environment.baseURL}compare`);\n  }\n\n  addToCompare(productId: number): Observable<{ message: string }> {\n    return this.http.post<{ message: string }>(`${environment.baseURL}compare`, {\n      product_id: productId,\n    });\n  }\n\n  removeFromCompare(productId: number): Observable<{ message: string }> {\n    return this.http.delete<{ message: string }>(\n      `${environment.baseURL}compare/${productId}`,\n    );\n  }\n}\n", "import { Injectable, inject } from '@angular/core';\nimport { Router } from '@angular/router';\n\nimport { Action, Selector, State, StateContext, Store } from '@ngxs/store';\nimport { tap } from 'rxjs';\n\nimport { IProduct } from '../../interface/product.interface';\nimport { CompareService } from '../../services/compare.service';\nimport { NotificationService } from '../../services/notification.service';\nimport {\n  AddToCompareAction,\n  DeleteCompareAction,\n  GetCompareAction,\n} from '../action/compare.action';\n\nexport class CompareStateModel {\n  items: IProduct[];\n  total: number;\n  comparIds: number[];\n}\n\n@State<CompareStateModel>({\n  name: 'compare',\n  defaults: {\n    items: [],\n    total: 0,\n    comparIds: [],\n  },\n})\n@Injectable()\nexport class CompareState {\n  private store = inject(Store);\n  router = inject(Router);\n  private notificationService = inject(NotificationService);\n  private compareService = inject(CompareService);\n\n  @Selector()\n  static compareItems(state: CompareStateModel) {\n    return state.items;\n  }\n\n  @Selector()\n  static compareIds(state: CompareStateModel) {\n    return state.comparIds;\n  }\n\n  @Selector()\n  static compareTotal(state: CompareStateModel) {\n    return state.total;\n  }\n\n  @Action(GetCompareAction)\n  getCompareItems(ctx: StateContext<CompareStateModel>) {\n    if (!this.store.selectSnapshot(state => state.auth && state.auth.access_token)) {\n      return;\n    }\n    this.compareService.skeletonLoader = true;\n    return this.compareService.getComparItems().pipe(\n      tap({\n        next: result => {\n          const data = Array.isArray(result) ? result : result.data || [];\n          const ids = data.map((product: IProduct) => product.id);\n          ctx.patchState({\n            items: data,\n            total: result?.total ? result.total : data.length,\n            comparIds: ids,\n          });\n        },\n        complete: () => {\n          this.compareService.skeletonLoader = false;\n        },\n        error: err => {\n          this.compareService.skeletonLoader = false;\n          throw new Error(err?.error?.message);\n        },\n      }),\n    );\n  }\n\n  @Action(AddToCompareAction)\n  add(ctx: StateContext<CompareStateModel>, action: AddToCompareAction) {\n    if (!this.store.selectSnapshot(state => state.auth && state.auth.access_token)) {\n      this.notificationService.showError('Please login to compare products.');\n      return;\n    }\n    const productId = action.payload?.['product_id'];\n    if (!productId) return;\n\n    return this.compareService.addToCompare(productId).pipe(\n      tap({\n        next: () => {\n          const state = ctx.getState();\n          if (!state.comparIds.includes(productId)) {\n            ctx.patchState({\n              comparIds: [...state.comparIds, productId],\n            });\n          }\n          this.notificationService.showSuccess('Added to compare.');\n          this.store.dispatch(new GetCompareAction());\n        },\n        error: err => {\n          this.notificationService.showError(\n            err?.error?.message || 'Failed to add to compare.',\n          );\n        },\n      }),\n    );\n  }\n\n  @Action(DeleteCompareAction)\n  delete(ctx: StateContext<CompareStateModel>, { id }: DeleteCompareAction) {\n    return this.compareService.removeFromCompare(id).pipe(\n      tap({\n        next: () => {\n          const state = ctx.getState();\n          ctx.patchState({\n            items: state.items.filter(item => item.id !== id),\n            total: state.total - 1,\n            comparIds: state.comparIds.filter(cId => cId !== id),\n          });\n          this.notificationService.showSuccess('Removed from compare.');\n        },\n        error: err => {\n          this.notificationService.showError(\n            err?.error?.message || 'Failed to remove from compare.',\n          );\n        },\n      }),\n    );\n  }\n}\n"],
  "mappings": "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",
  "names": ["CompareState"]
}
