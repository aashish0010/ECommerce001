{
  "version": 3,
  "sources": ["src/app/shared/store/action/wishlist.action.ts", "src/app/shared/services/wishlist.service.ts", "src/app/shared/store/state/wishlist.state.ts"],
  "sourcesContent": ["import { Params } from '../../interface/core.interface';\n\nexport class GetWishlistAction {\n  static readonly type = '[Wishlist] Get';\n}\n\nexport class AddToWishlistAction {\n  static readonly type = '[Wishlist] post';\n  constructor(public payload: Params) {}\n}\n\nexport class DeleteWishlistAction {\n  static readonly type = '[Wishlist] delete';\n  constructor(public id: number) {}\n}\n", "import { HttpClient } from '@angular/common/http';\nimport { Injectable, inject } from '@angular/core';\n\nimport { Observable } from 'rxjs';\n\nimport { environment } from '../../../environments/environment';\nimport { IWishlistModel } from '../interface/wishlist.interface';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class WishlistService {\n  private http = inject(HttpClient);\n\n  public skeletonLoader: boolean = false;\n\n  getWishlistItems(): Observable<IWishlistModel> {\n    return this.http.get<IWishlistModel>(`${environment.baseURL}wishlist`);\n  }\n\n  addToWishlist(productId: number): Observable<{ message: string }> {\n    return this.http.post<{ message: string }>(`${environment.baseURL}wishlist`, {\n      product_id: productId,\n    });\n  }\n\n  removeFromWishlist(productId: number): Observable<{ message: string }> {\n    return this.http.delete<{ message: string }>(\n      `${environment.baseURL}wishlist/${productId}`,\n    );\n  }\n}\n", "import { Injectable, inject } from '@angular/core';\nimport { Router } from '@angular/router';\n\nimport { Action, Selector, State, StateContext, Store } from '@ngxs/store';\nimport { tap } from 'rxjs';\n\nimport { IProduct } from '../../interface/product.interface';\nimport { NotificationService } from '../../services/notification.service';\nimport { WishlistService } from '../../services/wishlist.service';\nimport {\n  GetWishlistAction,\n  AddToWishlistAction,\n  DeleteWishlistAction,\n} from '../action/wishlist.action';\n\nexport class WishlistStateModel {\n  wishlist = {\n    data: [] as IProduct[],\n    total: 0,\n  };\n  wishlistIds: number[];\n}\n\n@State<WishlistStateModel>({\n  name: 'wishlist',\n  defaults: {\n    wishlist: {\n      data: [],\n      total: 0,\n    },\n    wishlistIds: [],\n  },\n})\n@Injectable()\nexport class WishlistState {\n  private store = inject(Store);\n  router = inject(Router);\n  private wishlistService = inject(WishlistService);\n  private notificationService = inject(NotificationService);\n\n  @Selector()\n  static wishlistItems(state: WishlistStateModel) {\n    return state.wishlist;\n  }\n\n  @Selector()\n  static wishlistIds(state: WishlistStateModel) {\n    return state.wishlistIds;\n  }\n\n  @Action(GetWishlistAction)\n  getWishlistItems(ctx: StateContext<WishlistStateModel>) {\n    if (!this.store.selectSnapshot(state => state.auth && state.auth.access_token)) {\n      return;\n    }\n    this.wishlistService.skeletonLoader = true;\n    return this.wishlistService.getWishlistItems().pipe(\n      tap({\n        next: result => {\n          const data = Array.isArray(result) ? result : result.data || [];\n          const ids = data.map((product: IProduct) => product.id);\n          ctx.patchState({\n            wishlist: {\n              data: data,\n              total: result?.total ? result.total : data.length,\n            },\n            wishlistIds: ids,\n          });\n        },\n        complete: () => {\n          this.wishlistService.skeletonLoader = false;\n        },\n        error: err => {\n          this.wishlistService.skeletonLoader = false;\n          throw new Error(err?.error?.message);\n        },\n      }),\n    );\n  }\n\n  @Action(AddToWishlistAction)\n  add(ctx: StateContext<WishlistStateModel>, action: AddToWishlistAction) {\n    if (!this.store.selectSnapshot(state => state.auth && state.auth.access_token)) {\n      this.notificationService.showError('Please login to add items to wishlist.');\n      return;\n    }\n    const productId = action.payload?.['product_id'];\n    if (!productId) return;\n\n    return this.wishlistService.addToWishlist(productId).pipe(\n      tap({\n        next: () => {\n          const state = ctx.getState();\n          if (!state.wishlistIds.includes(productId)) {\n            ctx.patchState({\n              wishlistIds: [...state.wishlistIds, productId],\n            });\n          }\n          this.notificationService.showSuccess('Added to wishlist.');\n          this.store.dispatch(new GetWishlistAction());\n        },\n        error: err => {\n          this.notificationService.showError(\n            err?.error?.message || 'Failed to add to wishlist.',\n          );\n        },\n      }),\n    );\n  }\n\n  @Action(DeleteWishlistAction)\n  delete(ctx: StateContext<WishlistStateModel>, { id }: DeleteWishlistAction) {\n    return this.wishlistService.removeFromWishlist(id).pipe(\n      tap({\n        next: () => {\n          const state = ctx.getState();\n          ctx.patchState({\n            wishlist: {\n              data: state.wishlist.data.filter(value => value.id !== id),\n              total: state.wishlist.total - 1,\n            },\n            wishlistIds: state.wishlistIds.filter(wId => wId !== id),\n          });\n          this.notificationService.showSuccess('Removed from wishlist.');\n        },\n        error: err => {\n          this.notificationService.showError(\n            err?.error?.message || 'Failed to remove from wishlist.',\n          );\n        },\n      }),\n    );\n  }\n}\n"],
  "mappings": "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",
  "names": ["WishlistState"]
}
