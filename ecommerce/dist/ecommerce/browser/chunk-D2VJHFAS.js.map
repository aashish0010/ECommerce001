{
  "version": 3,
  "sources": ["src/app/shared/store/action/theme-option.action.ts", "src/app/shared/services/company-detail.service.ts", "src/app/shared/store/state/theme-option.state.ts"],
  "sourcesContent": ["export class ThemeOptionsAction {\n  static readonly type = '[Theme IOption] Get';\n}\n\nexport class UpdateSessionAction {\n  static readonly type = '[Theme IOption] Update Session';\n  constructor(\n    public slug: string,\n    public value: boolean,\n  ) {}\n}\n\nexport class UpdateProductBoxAction {\n  static readonly type = '[Theme IOption] Update Product Box';\n  constructor(public value: string) {}\n}\n", "import { HttpClient } from '@angular/common/http';\nimport { Injectable, inject } from '@angular/core';\n\nimport { Observable } from 'rxjs';\n\nimport { environment } from '../../../environments/environment';\nimport { ICompanyDetailResponse } from '../interface/company-detail.interface';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class CompanyDetailService {\n  private http = inject(HttpClient);\n\n  getCompanyDetails(): Observable<ICompanyDetailResponse> {\n    const companyCode = encodeURIComponent(environment.companyCode);\n    return this.http.get<ICompanyDetailResponse>(\n      `${environment.baseURL}Auth/companydetails?companyCode=${companyCode}`,\n    );\n  }\n}\n", "import { Injectable, inject } from '@angular/core';\n\nimport { Action, Selector, State, StateContext } from '@ngxs/store';\nimport { catchError, forkJoin, of, tap, timeout } from 'rxjs';\n\nimport { ICompanyDetailResponse } from '../../interface/company-detail.interface';\nimport { IThemeOptionStateModel } from '../../interface/theme-option.interface';\nimport { CompanyDetailService } from '../../services/company-detail.service';\nimport { ThemeOptionService } from '../../services/theme-option.service';\nimport {\n  ThemeOptionsAction,\n  UpdateProductBoxAction,\n  UpdateSessionAction,\n} from '../action/theme-option.action';\n\n@State<IThemeOptionStateModel>({\n  name: 'theme_option',\n  defaults: {\n    theme_option: null,\n    exit: true,\n    cookies: true,\n    newsletter: true,\n    productBox: '',\n  },\n})\n@Injectable()\nexport class ThemeOptionState {\n  private themeOptionService = inject(ThemeOptionService);\n  private companyDetailService = inject(CompanyDetailService);\n\n  @Selector()\n  static themeOptions(state: IThemeOptionStateModel) {\n    return state.theme_option;\n  }\n\n  @Selector()\n  static exit(state: IThemeOptionStateModel) {\n    return state.exit;\n  }\n\n  @Selector()\n  static cookies(state: IThemeOptionStateModel) {\n    return state.cookies;\n  }\n\n  @Selector()\n  static newsletter(state: IThemeOptionStateModel) {\n    return state.newsletter;\n  }\n\n  @Selector()\n  static productBox(state: IThemeOptionStateModel) {\n    return state.productBox;\n  }\n\n  @Action(ThemeOptionsAction)\n  getThemeOptions(ctx: StateContext<IThemeOptionStateModel>) {\n    return forkJoin({\n      theme: this.themeOptionService\n        .getThemeOption()\n        .pipe(timeout(3000), catchError(() => of({ options: {} }))),\n      company: this.companyDetailService\n        .getCompanyDetails()\n        .pipe(timeout(3000), catchError(() => of(null))),\n    }).pipe(\n      tap({\n        next: result => {\n          const state = ctx.getState();\n          const baseOptions = result?.theme?.options ?? result?.theme ?? {};\n          const mergedOptions = result?.company\n            ? this.applyCompanyDetails(baseOptions, result.company)\n            : baseOptions;\n          ctx.setState({\n            ...state,\n            theme_option: mergedOptions,\n          });\n        },\n        error: err => {\n          throw new Error(err?.error?.message);\n        },\n      }),\n    );\n  }\n\n  @Action(UpdateSessionAction)\n  UpdateSession(ctx: StateContext<IThemeOptionStateModel>, action: UpdateSessionAction) {\n    const state = ctx.getState();\n    ctx.patchState({\n      ...state,\n      cookies: action.slug == 'cookies' ? action.value : state.cookies,\n      exit: action.slug == 'exit' ? action.value : state.exit,\n      newsletter: action.slug == 'newsletter' ? action.value : state.newsletter,\n    });\n  }\n\n  @Action(UpdateProductBoxAction)\n  UpdateProductBox(ctx: StateContext<IThemeOptionStateModel>, action: UpdateProductBoxAction) {\n    const state = ctx.getState();\n    ctx.patchState({\n      ...state,\n      productBox: action.value,\n    });\n  }\n\n  private applyCompanyDetails(options: any, response: ICompanyDetailResponse) {\n    if (!options || !response?.companyDetailRes?.companyDetail) {\n      return options;\n    }\n\n    const detail = response.companyDetailRes.companyDetail;\n    const services = response.companyDetailRes.companyServices || [];\n    const social = response.companyDetailRes.companySocialInfos || [];\n\n    const findSocial = (name: string) =>\n      social.find(item => item?.socialMediaName?.toLowerCase() === name.toLowerCase())\n        ?.socialMediaLink;\n\n    const serviceNames = services\n      .map(service => service?.name)\n      .filter((name): name is string => Boolean(name));\n\n    return {\n      ...options,\n      general: {\n        ...options.general,\n        site_title: detail.companyName || options.general?.site_title,\n        site_tagline: detail.companyDescription || options.general?.site_tagline,\n      },\n      seo: {\n        ...options.seo,\n        meta_title: detail.companyName || options.seo?.meta_title,\n        og_title: detail.companyName || options.seo?.og_title,\n        meta_description: detail.companyDescription || options.seo?.meta_description,\n        og_description: detail.companyDescription || options.seo?.og_description,\n        meta_tags: serviceNames.length ? serviceNames.join(', ') : options.seo?.meta_tags,\n      },\n      header: {\n        ...options.header,\n        support_number: detail.companyPhoneNumber || options.header?.support_number,\n      },\n      footer: {\n        ...options.footer,\n        footer_about: detail.companyDescription || options.footer?.footer_about,\n        about_email: detail.companyEmail || options.footer?.about_email,\n        support_email: detail.companyEmail || options.footer?.support_email,\n        support_number: detail.companyPhoneNumber || options.footer?.support_number,\n        facebook: findSocial('Facebook') || options.footer?.facebook,\n        instagram: findSocial('Instagram') || options.footer?.instagram,\n        twitter: findSocial('Twitter') || '',\n        pinterest: findSocial('Pinterest') || '',\n        tiktok: findSocial('Tiktok') || '',\n      },\n      contact_us: {\n        ...options.contact_us,\n        description: detail.companyDescription || options.contact_us?.description,\n        detail_1: {\n          ...options.contact_us?.detail_1,\n          text: detail.companyPhoneNumber || options.contact_us?.detail_1?.text,\n        },\n        detail_3: {\n          ...options.contact_us?.detail_3,\n          text: detail.companyEmail || options.contact_us?.detail_3?.text,\n        },\n        detail_4: {\n          ...options.contact_us?.detail_4,\n          text: detail.companyEmail || options.contact_us?.detail_4?.text,\n        },\n      },\n      about_us: {\n        ...options.about_us,\n        about: {\n          ...options.about_us?.about,\n          description: detail.companyDescription || options.about_us?.about?.description,\n        },\n      },\n    };\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAM,IAAO,qBAAP,MAAyB;;AACb,SAAA,OAAO;EAAsB;;AAGzC,IAAO,sBAAP,MAA0B;;AACd,SAAA,OAAO;EAAiC;EACxD,YACS,MACA,OAAc;AADd,SAAA,OAAA;AACA,SAAA,QAAA;EACN;;AAGC,IAAO,yBAAP,MAA6B;;AACjB,SAAA,OAAO;EAAqC;EAC5D,YAAmB,OAAa;AAAb,SAAA,QAAA;EAAgB;;;;ACH/B,IAAO,uBAAP,MAAO,sBAAoB;EAHjC,cAAA;AAIU,SAAA,OAAO,OAAO,UAAU;;EAEhC,oBAAiB;AACf,UAAM,cAAc,mBAAmB,YAAY,WAAW;AAC9D,WAAO,KAAK,KAAK,IACf,GAAG,YAAY,OAAO,mCAAmC,WAAW,EAAE;EAE1E;;;uCARW,uBAAoB;IAAA;EAAA;;4EAApB,uBAAoB,SAApB,sBAAoB,WAAA,YAFnB,OAAM,CAAA;EAAA;;;sEAEP,sBAAoB,CAAA;UAHhC;WAAW;MACV,YAAY;KACb;;;;;ACgBM,IAAM,mBAAN,MAAMA,kBAAgB;EAAtB,cAAA;AACG,SAAA,qBAAqB,OAAO,kBAAkB;AAC9C,SAAA,uBAAuB,OAAO,oBAAoB;;EAG1D,OAAO,aAAa,OAA6B;AAC/C,WAAO,MAAM;EACf;EAGA,OAAO,KAAK,OAA6B;AACvC,WAAO,MAAM;EACf;EAGA,OAAO,QAAQ,OAA6B;AAC1C,WAAO,MAAM;EACf;EAGA,OAAO,WAAW,OAA6B;AAC7C,WAAO,MAAM;EACf;EAGA,OAAO,WAAW,OAA6B;AAC7C,WAAO,MAAM;EACf;EAGA,gBAAgB,KAAyC;AACvD,WAAO,SAAS;MACd,OAAO,KAAK,mBACT,eAAc,EACd,KAAK,QAAQ,GAAI,GAAG,WAAW,MAAM,GAAG,EAAE,SAAS,CAAA,EAAE,CAAE,CAAC,CAAC;MAC5D,SAAS,KAAK,qBACX,kBAAiB,EACjB,KAAK,QAAQ,GAAI,GAAG,WAAW,MAAM,GAAG,IAAI,CAAC,CAAC;KAClD,EAAE,KACD,IAAI;MACF,MAAM,YAAS;AACb,cAAM,QAAQ,IAAI,SAAQ;AAC1B,cAAM,cAAc,QAAQ,OAAO,WAAW,QAAQ,SAAS,CAAA;AAC/D,cAAM,gBAAgB,QAAQ,UAC1B,KAAK,oBAAoB,aAAa,OAAO,OAAO,IACpD;AACJ,YAAI,SAAS,iCACR,QADQ;UAEX,cAAc;UACf;MACH;MACA,OAAO,SAAM;AACX,cAAM,IAAI,MAAM,KAAK,OAAO,OAAO;MACrC;KACD,CAAC;EAEN;EAGA,cAAc,KAA2C,QAA2B;AAClF,UAAM,QAAQ,IAAI,SAAQ;AAC1B,QAAI,WAAW,iCACV,QADU;MAEb,SAAS,OAAO,QAAQ,YAAY,OAAO,QAAQ,MAAM;MACzD,MAAM,OAAO,QAAQ,SAAS,OAAO,QAAQ,MAAM;MACnD,YAAY,OAAO,QAAQ,eAAe,OAAO,QAAQ,MAAM;MAChE;EACH;EAGA,iBAAiB,KAA2C,QAA8B;AACxF,UAAM,QAAQ,IAAI,SAAQ;AAC1B,QAAI,WAAW,iCACV,QADU;MAEb,YAAY,OAAO;MACpB;EACH;EAEQ,oBAAoB,SAAc,UAAgC;AACxE,QAAI,CAAC,WAAW,CAAC,UAAU,kBAAkB,eAAe;AAC1D,aAAO;IACT;AAEA,UAAM,SAAS,SAAS,iBAAiB;AACzC,UAAM,WAAW,SAAS,iBAAiB,mBAAmB,CAAA;AAC9D,UAAM,SAAS,SAAS,iBAAiB,sBAAsB,CAAA;AAE/D,UAAM,aAAa,CAAC,SAClB,OAAO,KAAK,UAAQ,MAAM,iBAAiB,YAAW,MAAO,KAAK,YAAW,CAAE,GAC3E;AAEN,UAAM,eAAe,SAClB,IAAI,aAAW,SAAS,IAAI,EAC5B,OAAO,CAAC,SAAyB,QAAQ,IAAI,CAAC;AAEjD,WAAO,iCACF,UADE;MAEL,SAAS,iCACJ,QAAQ,UADJ;QAEP,YAAY,OAAO,eAAe,QAAQ,SAAS;QACnD,cAAc,OAAO,sBAAsB,QAAQ,SAAS;;MAE9D,KAAK,iCACA,QAAQ,MADR;QAEH,YAAY,OAAO,eAAe,QAAQ,KAAK;QAC/C,UAAU,OAAO,eAAe,QAAQ,KAAK;QAC7C,kBAAkB,OAAO,sBAAsB,QAAQ,KAAK;QAC5D,gBAAgB,OAAO,sBAAsB,QAAQ,KAAK;QAC1D,WAAW,aAAa,SAAS,aAAa,KAAK,IAAI,IAAI,QAAQ,KAAK;;MAE1E,QAAQ,iCACH,QAAQ,SADL;QAEN,gBAAgB,OAAO,sBAAsB,QAAQ,QAAQ;;MAE/D,QAAQ,iCACH,QAAQ,SADL;QAEN,cAAc,OAAO,sBAAsB,QAAQ,QAAQ;QAC3D,aAAa,OAAO,gBAAgB,QAAQ,QAAQ;QACpD,eAAe,OAAO,gBAAgB,QAAQ,QAAQ;QACtD,gBAAgB,OAAO,sBAAsB,QAAQ,QAAQ;QAC7D,UAAU,WAAW,UAAU,KAAK,QAAQ,QAAQ;QACpD,WAAW,WAAW,WAAW,KAAK,QAAQ,QAAQ;QACtD,SAAS,WAAW,SAAS,KAAK;QAClC,WAAW,WAAW,WAAW,KAAK;QACtC,QAAQ,WAAW,QAAQ,KAAK;;MAElC,YAAY,iCACP,QAAQ,aADD;QAEV,aAAa,OAAO,sBAAsB,QAAQ,YAAY;QAC9D,UAAU,iCACL,QAAQ,YAAY,WADf;UAER,MAAM,OAAO,sBAAsB,QAAQ,YAAY,UAAU;;QAEnE,UAAU,iCACL,QAAQ,YAAY,WADf;UAER,MAAM,OAAO,gBAAgB,QAAQ,YAAY,UAAU;;QAE7D,UAAU,iCACL,QAAQ,YAAY,WADf;UAER,MAAM,OAAO,gBAAgB,QAAQ,YAAY,UAAU;;;MAG/D,UAAU,iCACL,QAAQ,WADH;QAER,OAAO,iCACF,QAAQ,UAAU,QADhB;UAEL,aAAa,OAAO,sBAAsB,QAAQ,UAAU,OAAO;;;;EAI3E;;;uCAtJWA,mBAAgB;IAAA;EAAA;;4EAAhBA,mBAAgB,SAAhBA,kBAAgB,UAAA,CAAA;EAAA;;AA8B3B,WAAA;EADC,OAAO,kBAAkB;;AA8B1B,WAAA;EADC,OAAO,mBAAmB;;AAY3B,WAAA;EADC,OAAO,sBAAsB;;AAhEvB,WAAA;EADN,SAAQ;;AAMF,WAAA;EADN,SAAQ;;AAMF,WAAA;EADN,SAAQ;;AAMF,WAAA;EADN,SAAQ;;AAMF,WAAA;EADN,SAAQ;;AAxBE,mBAAgB,WAAA;EAX5B,MAA8B;IAC7B,MAAM;IACN,UAAU;MACR,cAAc;MACd,MAAM;MACN,SAAS;MACT,YAAY;MACZ,YAAY;;GAEf;GAEY,gBAAgB;;sEAAhB,kBAAgB,CAAA;UAD5B;;;",
  "names": ["ThemeOptionState"]
}
