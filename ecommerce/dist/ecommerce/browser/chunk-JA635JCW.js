import{i as U}from"./chunk-F62LBTWT.js";import{A as f,E as n}from"./chunk-KTUN43P2.js";import{$ as p,U as a,ea as d,g as o,qd as c,rd as w,sd as u}from"./chunk-XZ37OMXB.js";import{a as h,b as A}from"./chunk-4CLCTAJ7.js";var S=(()=>{class s{static{this.type="[Account] User Get"}constructor(){}}return s})(),N=(()=>{class s{static{this.type="[Account] User Update"}constructor(e){this.payload=e}}return s})(),P=(()=>{class s{static{this.type="[Account] User Update Password"}constructor(e){this.payload=e}}return s})(),g=(()=>{class s{static{this.type="[Account] Addresses Get"}constructor(){}}return s})(),v=(()=>{class s{static{this.type="[Account] Address Create"}constructor(e){this.payload=e}}return s})(),y=(()=>{class s{static{this.type="[Account] Address Edit"}constructor(e,r){this.payload=e,this.id=r}}return s})(),x=(()=>{class s{static{this.type="[Account] Address Delete"}constructor(e){this.id=e}}return s})(),b=(()=>{class s{static{this.type="[Account] Clear"}constructor(){}}return s})();var D=(()=>{class s{constructor(){this.http=d(f),this.isOpenMenu=!1}getUserDetails(){return this.http.get(`${n.baseURL}user/me`)}updateProfile(e){return this.http.put(`${n.baseURL}user/profile`,e)}updatePassword(e){return this.http.put(`${n.baseURL}user/password`,{currentPassword:e.current_password,newPassword:e.new_password,confirmPassword:e.confirm_password})}getAddresses(){return this.http.get(`${n.baseURL}address`)}createAddress(e){return this.http.post(`${n.baseURL}address`,e)}static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275prov=p({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();var i=class l{constructor(){this.accountService=d(D),this.notificationService=d(U)}static user(t){return t.user}static permissions(t){return t.permissions}static addresses(t){return t.addresses}getUserDetails(t){return this.accountService.getUserDetails().pipe(a({next:e=>{let r=A(h({},e),{name:[e.firstName,e.middleName,e.lastName].filter(Boolean).join(" ")||e.name,phone:e.phoneNumber||e.phone});t.patchState({user:r,permissions:e.permission||[]})},error:e=>{throw new Error(e?.error?.message)}}))}updateProfile(t,{payload:e}){if(e instanceof FormData){this.notificationService.showError("Profile image upload is not yet supported");return}return this.accountService.updateProfile(e).pipe(a({next:()=>{this.notificationService.showSuccess("Profile updated successfully");let r=t.getState().user;if(r){let m=[e.firstName,e.middleName,e.lastName].filter(Boolean).join(" ");t.patchState({user:A(h({},r),{firstName:e.firstName??r.firstName,middleName:e.middleName??r.middleName,lastName:e.lastName??r.lastName,phoneNumber:e.phoneNumber??r.phoneNumber,phone:e.phoneNumber??r.phone,name:m||r.name})})}},error:r=>{this.notificationService.showError(r?.error?.message||"Failed to update profile")}}))}updatePassword(t,{payload:e}){return this.accountService.updatePassword(e).pipe(a({next:()=>{this.notificationService.showSuccess("Password changed successfully")},error:r=>{this.notificationService.showError(r?.error?.message||"Failed to change password")}}))}getAddresses(t){return this.accountService.getAddresses().pipe(a({next:e=>{t.patchState({addresses:e})},error:e=>{throw new Error(e?.error?.message)}}))}createAddress(t,{payload:e}){return this.accountService.createAddress(e).pipe(a({next:r=>{let m=t.getState();t.patchState({addresses:[...m.addresses,r]})},error:r=>{throw new Error(r?.error?.message)}}))}updateAddress(t,e){}deleteAddress(t,e){}accountClear(t){t.patchState({user:null,permissions:[],addresses:[]})}static{this.\u0275fac=function(e){return new(e||l)}}static{this.\u0275prov=p({token:l,factory:l.\u0275fac})}};o([c(S)],i.prototype,"getUserDetails",null);o([c(N)],i.prototype,"updateProfile",null);o([c(P)],i.prototype,"updatePassword",null);o([c(g)],i.prototype,"getAddresses",null);o([c(v)],i.prototype,"createAddress",null);o([c(y)],i.prototype,"updateAddress",null);o([c(x)],i.prototype,"deleteAddress",null);o([c(b)],i.prototype,"accountClear",null);o([u()],i,"user",null);o([u()],i,"permissions",null);o([u()],i,"addresses",null);i=o([w({name:"account",defaults:{user:null,permissions:[],addresses:[]}})],i);export{S as a,N as b,g as c,v as d,y as e,x as f,b as g,D as h,i};
