{
  "version": 3,
  "sources": ["src/app/core/guard/auth.guard.ts"],
  "sourcesContent": ["import { inject, Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, RouterStateSnapshot } from '@angular/router';\n\nimport { Store } from '@ngxs/store';\n\nimport { AuthService } from '../../shared/services/auth.service';\nimport { GetUserDetailsAction } from '../../shared/store/action/account.action';\nimport { AccountState } from '../../shared/store/state/account.state';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthGuard {\n  private store = inject(Store);\n  private authService = inject(AuthService);\n\n  canActivate(_route: ActivatedRouteSnapshot, state: RouterStateSnapshot): boolean {\n    const token = this.store.selectSnapshot((s) => s.auth?.access_token);\n    if (!token) {\n      this.authService.redirectUrl = state.url;\n      this.authService.isLogin = true;\n      return false;\n    }\n\n    // Fetch user data in the background if not already in state.\n    // Do NOT await â€” return true immediately so the route activates\n    // and the component's own skeleton handles the loading state.\n    const user = this.store.selectSnapshot(AccountState.user);\n    if (!user) {\n      this.store.dispatch(new GetUserDetailsAction());\n    }\n\n    return true;\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;AAYM,IAAO,YAAP,MAAO,WAAS;EAHtB,cAAA;AAIU,SAAA,QAAQ,OAAO,KAAK;AACpB,SAAA,cAAc,OAAO,WAAW;;EAExC,YAAY,QAAgC,OAA0B;AACpE,UAAM,QAAQ,KAAK,MAAM,eAAe,CAAC,MAAM,EAAE,MAAM,YAAY;AACnE,QAAI,CAAC,OAAO;AACV,WAAK,YAAY,cAAc,MAAM;AACrC,WAAK,YAAY,UAAU;AAC3B,aAAO;IACT;AAKA,UAAM,OAAO,KAAK,MAAM,eAAe,aAAa,IAAI;AACxD,QAAI,CAAC,MAAM;AACT,WAAK,MAAM,SAAS,IAAI,qBAAoB,CAAE;IAChD;AAEA,WAAO;EACT;;;uCArBW,YAAS;IAAA;EAAA;;4EAAT,YAAS,SAAT,WAAS,WAAA,YAFR,OAAM,CAAA;EAAA;;;sEAEP,WAAS,CAAA;UAHrB;WAAW;MACV,YAAY;KACb;;;",
  "names": []
}
