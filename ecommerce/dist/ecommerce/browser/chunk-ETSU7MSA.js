import{a as C}from"./chunk-XBPV4G5P.js";import{m as i,n as h,o as a}from"./chunk-HS6BDBTJ.js";import{A as m}from"./chunk-QOHFTPSE.js";import{X as l,ca as u,ha as c,i as r}from"./chunk-63KUFEGV.js";var f=(()=>{class t{static{this.type="[Coupon] Get"}}return t})(),d=(()=>{class t{static{this.type="[Coupon] Apply"}constructor(p,n){this.code=p,this.subtotal=n}}return t})(),y=(()=>{class t{static{this.type="[Coupon] Remove"}}return t})();var v=(()=>{class t{constructor(){this.http=c(m)}getCoupons(){return this.http.get(`${C.baseURL}coupon`)}applyCoupon(p,n){return this.http.post(`${C.baseURL}coupon/apply`,{code:p,subtotal:n,company_info_id:1})}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=u({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var e=class s{constructor(){this.couponService=c(v)}static coupons(o){return o.coupons}static appliedCoupon(o){return o.appliedCoupon}static couponError(o){return o.couponError}getCoupons(o){return this.couponService.getCoupons().pipe(l({next:p=>{o.patchState({coupons:p.data??[]})},error:()=>{o.patchState({coupons:[]})}}))}applyCoupon(o,p){return o.patchState({couponError:null}),this.couponService.applyCoupon(p.code,p.subtotal).pipe(l({next:n=>{o.patchState({appliedCoupon:n,couponError:null})},error:n=>{throw o.patchState({appliedCoupon:null,couponError:n?.error?.message??"Invalid coupon code."}),new Error(n?.error?.message??"Invalid coupon code.")}}))}removeCoupon(o){o.patchState({appliedCoupon:null,couponError:null})}static{this.\u0275fac=function(p){return new(p||s)}}static{this.\u0275prov=u({token:s,factory:s.\u0275fac})}};r([i(f)],e.prototype,"getCoupons",null);r([i(d)],e.prototype,"applyCoupon",null);r([i(y)],e.prototype,"removeCoupon",null);r([a()],e,"coupons",null);r([a()],e,"appliedCoupon",null);r([a()],e,"couponError",null);e=r([h({name:"coupon",defaults:{coupons:[],appliedCoupon:null,couponError:null}})],e);export{f as a,d as b,y as c,e as d};
