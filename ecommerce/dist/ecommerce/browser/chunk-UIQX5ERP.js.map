{
  "version": 3,
  "sources": ["src/app/shared/services/order.service.ts", "src/app/shared/store/state/order.state.ts"],
  "sourcesContent": ["import { HttpClient } from '@angular/common/http';\nimport { Injectable, inject } from '@angular/core';\nimport { Params } from '@angular/router';\n\nimport { Observable } from 'rxjs';\n\nimport { environment } from '../../../environments/environment';\nimport { IOrder } from '../interface/order.interface';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class OrderService {\n  private http = inject(HttpClient);\n\n  public skeletonLoader: boolean = false;\n\n  getOrders(payload?: Params): Observable<IOrder[]> {\n    return this.http.get<IOrder[]>(`${environment.baseURL}order`);\n  }\n\n  viewOrder(id: string): Observable<IOrder> {\n    return this.http.get<IOrder>(`${environment.baseURL}order/${id}`);\n  }\n\n  orderTracking(payload: { order_number: string; email_or_phone: string }): Observable<IOrder> {\n    return this.http.get<IOrder>(`${environment.URL}/trackOrder`, { params: payload });\n  }\n\n  placeOrder(payload: any): Observable<any> {\n    return this.http.post<any>(`${environment.baseURL}order`, payload);\n  }\n}\n", "import { Injectable, inject } from '@angular/core';\nimport { Router } from '@angular/router';\n\nimport { Action, Selector, State, StateContext } from '@ngxs/store';\nimport { tap } from 'rxjs';\n\nimport { IOrder, IOrderCheckout } from '../../interface/order.interface';\nimport { NotificationService } from '../../services/notification.service';\nimport { OrderService } from '../../services/order.service';\nimport {\n  CheckoutAction,\n  DownloadInvoiceAction,\n  GetOrdersAction,\n  OrderTrackingAction,\n  PlaceOrderAction,\n  RePaymentAction,\n  ViewOrderAction,\n} from '../action/order.action';\n\nexport class OrderStateModel {\n  order = {\n    data: [] as IOrder[],\n    total: 0,\n  };\n  selectedOrder: IOrder | null;\n  checkout: IOrderCheckout | null;\n}\n\n@State<OrderStateModel>({\n  name: 'order',\n  defaults: {\n    order: {\n      data: [],\n      total: 0,\n    },\n    selectedOrder: null,\n    checkout: null,\n  },\n})\n@Injectable()\nexport class OrderState {\n  private notificationService = inject(NotificationService);\n  private router = inject(Router);\n  private orderService = inject(OrderService);\n\n  @Selector()\n  static order(state: OrderStateModel) {\n    return state.order;\n  }\n\n  @Selector()\n  static selectedOrder(state: OrderStateModel) {\n    return state.selectedOrder;\n  }\n\n  @Selector()\n  static checkout(state: OrderStateModel) {\n    return state.checkout;\n  }\n\n  @Action(GetOrdersAction)\n  getOrders(ctx: StateContext<OrderStateModel>, action: GetOrdersAction) {\n    return this.orderService.getOrders(action?.payload).pipe(\n      tap({\n        next: (result: any) => {\n          // Backend returns a flat array; wrap it into the paginated model shape\n          const data: IOrder[] = Array.isArray(result) ? result : (result?.data ?? []);\n          ctx.patchState({\n            order: {\n              data,\n              total: data.length,\n            },\n          });\n        },\n        error: err => {\n          throw new Error(err?.error?.message);\n        },\n      }),\n    );\n  }\n\n  @Action(ViewOrderAction)\n  viewOrder(ctx: StateContext<OrderStateModel>, { id }: ViewOrderAction) {\n    this.orderService.skeletonLoader = true;\n    const cached = ctx.getState().order.data;\n    if (cached?.length) {\n      const result = cached.find(order => order.order_number == id);\n      ctx.patchState({ selectedOrder: result ?? null });\n      this.orderService.skeletonLoader = false;\n      return;\n    }\n    return this.orderService.getOrders().pipe(\n      tap({\n        next: (results: any) => {\n          const data: IOrder[] = Array.isArray(results) ? results : (results?.data ?? []);\n          const result = data.find(order => order.order_number == id);\n          ctx.patchState({ selectedOrder: result ?? null });\n        },\n        error: err => {\n          throw new Error(err?.error?.message);\n        },\n        complete: () => {\n          this.orderService.skeletonLoader = false;\n        },\n      }),\n    );\n  }\n\n  @Action(CheckoutAction)\n  checkout(ctx: StateContext<OrderStateModel>, _action: CheckoutAction) {\n    const state = ctx.getState();\n\n    // It Just Static IValues as per cart default value (When you are using api then you need calculate as per your requirement)\n    const order = {\n      total: {\n        convert_point_amount: 65.66,\n        convert_wallet_balance: 8.47,\n        coupon_total_discount: 10,\n        points: 1970,\n        points_amount: 65.66,\n        shipping_total: 0,\n        sub_total: 39.81,\n        tax_total: 1.99,\n        total: 41.8,\n        wallet_balance: 8.47,\n      },\n    };\n\n    ctx.patchState({\n      ...state,\n      checkout: order,\n    });\n  }\n\n  @Action(PlaceOrderAction)\n  placeOrder(_ctx: StateContext<OrderStateModel>, action: PlaceOrderAction) {\n    return this.orderService.placeOrder(action.payload).pipe(\n      tap({\n        next: (result) => {\n          this.notificationService.showSuccess(\n            `Order placed successfully! Order #${result.order_number}`,\n          );\n          void this.router.navigate(['/']);\n        },\n        error: (err) => {\n          this.notificationService.showError(\n            err?.error?.message || 'Failed to place order. Please try again.',\n          );\n        },\n      }),\n    );\n  }\n\n  @Action(RePaymentAction)\n  rePayment(_ctx: StateContext<OrderStateModel>, _action: RePaymentAction) {\n    // Repayment Logic Here\n  }\n\n  @Action(OrderTrackingAction)\n  orderTracking(ctx: StateContext<OrderStateModel>, action: OrderTrackingAction) {\n    // this.notificationService.notification = false;\n    return this.orderService.orderTracking(action.payload).pipe(\n      tap({\n        next: result => {\n          const state = ctx.getState();\n          ctx.patchState({\n            ...state,\n            selectedOrder: result,\n          });\n        },\n        error: err => {\n          throw new Error(err?.error?.message);\n        },\n      }),\n    );\n  }\n\n  @Action(DownloadInvoiceAction)\n  downloadInvoice(_ctx: StateContext<OrderStateModel>, _action: DownloadInvoiceAction) {\n    // Download invoice Logic Here\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAYM,IAAO,eAAP,MAAO,cAAY;EAHzB,cAAA;AAIU,SAAA,OAAO,OAAO,UAAU;AAEzB,SAAA,iBAA0B;;EAEjC,UAAU,SAAgB;AACxB,WAAO,KAAK,KAAK,IAAc,GAAG,YAAY,OAAO,OAAO;EAC9D;EAEA,UAAU,IAAU;AAClB,WAAO,KAAK,KAAK,IAAY,GAAG,YAAY,OAAO,SAAS,EAAE,EAAE;EAClE;EAEA,cAAc,SAAyD;AACrE,WAAO,KAAK,KAAK,IAAY,GAAG,YAAY,GAAG,eAAe,EAAE,QAAQ,QAAO,CAAE;EACnF;EAEA,WAAW,SAAY;AACrB,WAAO,KAAK,KAAK,KAAU,GAAG,YAAY,OAAO,SAAS,OAAO;EACnE;;;uCAnBW,eAAY;IAAA;EAAA;;4EAAZ,eAAY,SAAZ,cAAY,WAAA,YAFX,OAAM,CAAA;EAAA;;;sEAEP,cAAY,CAAA;UAHxB;WAAW;MACV,YAAY;KACb;;;;;AC6BM,IAAM,aAAN,MAAMA,YAAU;EAAhB,cAAA;AACG,SAAA,sBAAsB,OAAO,mBAAmB;AAChD,SAAA,SAAS,OAAO,MAAM;AACtB,SAAA,eAAe,OAAO,YAAY;;EAG1C,OAAO,MAAM,OAAsB;AACjC,WAAO,MAAM;EACf;EAGA,OAAO,cAAc,OAAsB;AACzC,WAAO,MAAM;EACf;EAGA,OAAO,SAAS,OAAsB;AACpC,WAAO,MAAM;EACf;EAGA,UAAU,KAAoC,QAAuB;AACnE,WAAO,KAAK,aAAa,UAAU,QAAQ,OAAO,EAAE,KAClD,IAAI;MACF,MAAM,CAAC,WAAe;AAEpB,cAAM,OAAiB,MAAM,QAAQ,MAAM,IAAI,SAAU,QAAQ,QAAQ,CAAA;AACzE,YAAI,WAAW;UACb,OAAO;YACL;YACA,OAAO,KAAK;;SAEf;MACH;MACA,OAAO,SAAM;AACX,cAAM,IAAI,MAAM,KAAK,OAAO,OAAO;MACrC;KACD,CAAC;EAEN;EAGA,UAAU,KAAoC,EAAE,GAAE,GAAmB;AACnE,SAAK,aAAa,iBAAiB;AACnC,UAAM,SAAS,IAAI,SAAQ,EAAG,MAAM;AACpC,QAAI,QAAQ,QAAQ;AAClB,YAAM,SAAS,OAAO,KAAK,WAAS,MAAM,gBAAgB,EAAE;AAC5D,UAAI,WAAW,EAAE,eAAe,UAAU,KAAI,CAAE;AAChD,WAAK,aAAa,iBAAiB;AACnC;IACF;AACA,WAAO,KAAK,aAAa,UAAS,EAAG,KACnC,IAAI;MACF,MAAM,CAAC,YAAgB;AACrB,cAAM,OAAiB,MAAM,QAAQ,OAAO,IAAI,UAAW,SAAS,QAAQ,CAAA;AAC5E,cAAM,SAAS,KAAK,KAAK,WAAS,MAAM,gBAAgB,EAAE;AAC1D,YAAI,WAAW,EAAE,eAAe,UAAU,KAAI,CAAE;MAClD;MACA,OAAO,SAAM;AACX,cAAM,IAAI,MAAM,KAAK,OAAO,OAAO;MACrC;MACA,UAAU,MAAK;AACb,aAAK,aAAa,iBAAiB;MACrC;KACD,CAAC;EAEN;EAGA,SAAS,KAAoC,SAAuB;AAClE,UAAM,QAAQ,IAAI,SAAQ;AAG1B,UAAM,QAAQ;MACZ,OAAO;QACL,sBAAsB;QACtB,wBAAwB;QACxB,uBAAuB;QACvB,QAAQ;QACR,eAAe;QACf,gBAAgB;QAChB,WAAW;QACX,WAAW;QACX,OAAO;QACP,gBAAgB;;;AAIpB,QAAI,WAAW,iCACV,QADU;MAEb,UAAU;MACX;EACH;EAGA,WAAW,MAAqC,QAAwB;AACtE,WAAO,KAAK,aAAa,WAAW,OAAO,OAAO,EAAE,KAClD,IAAI;MACF,MAAM,CAAC,WAAU;AACf,aAAK,oBAAoB,YACvB,qCAAqC,OAAO,YAAY,EAAE;AAE5D,aAAK,KAAK,OAAO,SAAS,CAAC,GAAG,CAAC;MACjC;MACA,OAAO,CAAC,QAAO;AACb,aAAK,oBAAoB,UACvB,KAAK,OAAO,WAAW,0CAA0C;MAErE;KACD,CAAC;EAEN;EAGA,UAAU,MAAqC,SAAwB;EAEvE;EAGA,cAAc,KAAoC,QAA2B;AAE3E,WAAO,KAAK,aAAa,cAAc,OAAO,OAAO,EAAE,KACrD,IAAI;MACF,MAAM,YAAS;AACb,cAAM,QAAQ,IAAI,SAAQ;AAC1B,YAAI,WAAW,iCACV,QADU;UAEb,eAAe;UAChB;MACH;MACA,OAAO,SAAM;AACX,cAAM,IAAI,MAAM,KAAK,OAAO,OAAO;MACrC;KACD,CAAC;EAEN;EAGA,gBAAgB,MAAqC,SAA8B;EAEnF;;;uCA5IWA,aAAU;IAAA;EAAA;;4EAAVA,aAAU,SAAVA,YAAU,UAAA,CAAA;EAAA;;AAqBrB,WAAA;EADC,OAAO,eAAe;;AAsBvB,WAAA;EADC,OAAO,eAAe;;AA4BvB,WAAA;EADC,OAAO,cAAc;;AA2BtB,WAAA;EADC,OAAO,gBAAgB;;AAoBxB,WAAA;EADC,OAAO,eAAe;;AAMvB,WAAA;EADC,OAAO,mBAAmB;;AAoB3B,WAAA;EADC,OAAO,qBAAqB;;AAnItB,WAAA;EADN,SAAQ;;AAMF,WAAA;EADN,SAAQ;;AAMF,WAAA;EADN,SAAQ;;AAfE,aAAU,WAAA;EAZtB,MAAuB;IACtB,MAAM;IACN,UAAU;MACR,OAAO;QACL,MAAM,CAAA;QACN,OAAO;;MAET,eAAe;MACf,UAAU;;GAEb;GAEY,UAAU;;sEAAV,YAAU,CAAA;UADtB;;;",
  "names": ["OrderState"]
}
